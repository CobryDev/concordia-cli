name: Documentation

on:
  push:
    branches: [main]
    paths:
      - "**.md"
      - ".github/workflows/docs.yml"

jobs:
  validate-docs:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          pip install markdown-link-check

      - name: Check for Broken Links
        run: |
          echo "## Documentation Validation 📚" >> $GITHUB_STEP_SUMMARY
          echo "Checking for broken links in all Markdown files..."
          find . -name "*.md" -print0 | xargs -0 markdown-link-check --quiet
          echo "✅ Link check complete" >> $GITHUB_STEP_SUMMARY
          
      - name: Validate Core Docs Exist
        run: |
          # Check if key documentation files exist
          if [ -f "README.md" ] && [ -f "tests/README.md" ]; then
            echo "✅ Core documentation files exist" >> $GITHUB_STEP_SUMMARY
          else
            echo "❌ Core documentation files are missing" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi